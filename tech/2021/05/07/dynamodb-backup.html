<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>DynamoDB backup to a different AWS account</title>
  <meta name="description" content="One of the well known ways to backup AWS DynamoDB is to use Data Pipelines and EMR. But there are few disadvantages with this approach like creation of tempo...">
  
  <meta name="author" content="Mahesh Kumar Kolla">
  <meta name="copyright" content="&copy; Mahesh Kumar Kolla 2021">
  

  <!-- External libraries -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/monokai-sublime.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css">

  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <link rel="shortcut icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="manifest" href="/assets/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  

  

  

  <!-- Site styles -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://maheshkkolla.github.io/tech/2021/05/07/dynamodb-backup.html">
  <link rel="alternate" type="application/rss+xml" title="Mahesh Kumar Kolla" href="http://maheshkkolla.github.io/feed.xml" />
</head>


  <body>

    <header class="navigation" role="banner">
  <div class="navigation-wrapper">
    <a href="/" class="logo">
      
      <span>Mahesh Kumar Kolla</span>
      
    </a>
    <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">
      <i class="fa fa-bars"></i>
    </a>
    <nav role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
        
          
          <li class="nav-link"><a href="/about/">About</a>
          
        
          
        
          
        
          
        
          
          <li class="nav-link"><a href="/posts/">Posts</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </ul>
    </nav>
  </div>
</header>


    <div class="page-content">
        <div class="post">

<div class="post-header-container " >
  <div class="scrim ">
    <header class="post-header">
      <h1 class="title">DynamoDB backup to a different AWS account</h1>
      <p class="info">by <strong>Mahesh Kumar Kolla</strong></p>
    </header>
  </div>
</div>

<div class="wrapper">

 <span class="page-divider">
  <span class="one"></span>
  <span class="two"></span>
</span>
 

<section class="post-meta">
  <div class="post-date">May 7, 2021</div>
  <div class="post-categories">
  in 
    
    <a href="/category/tech">Tech</a>
    
  
  </div>
</section>

<article class="post-content">
  <p>One of the well known ways to backup AWS DynamoDB is to use Data Pipelines and EMR. 
But there are few disadvantages with this approach like creation of temporary EC2 instance, 
using provisioned read capacity of the DynamoDB table for backup and it could take a lot of time to backup 
depends on the size of data, size of EC2 instance and provisioned read capacity etc., 
Overall this could even lead to high costs and less maintainable.</p>

<p>AWS has released a feature “Export to S3” which solves a lot these problems. 
This is a complete serverless solution. Hence it is scalable and performant. 
Exporting feature does not consume provisioned read capacity of the table, as a result it has no impact on the performance and availability of the Dynamo table.</p>

<h1 id="how-to-backup">How to backup?</h1>

<h3 id="enable-pitr-point-in-time-recovery">Enable PITR (Point in time recovery)</h3>

<p>First we need to enable the PITR (Point in time recovery) on the DynamoDB.</p>
<ul>
  <li>Go to the Dynamo table in the console</li>
  <li>Navigate to Backups tab</li>
  <li>You see an option to enable to PITR as below image</li>
</ul>

<p><img src="/assets/tech/dynamo-backup/pitr.png" /></p>

<p>From Terraform: Add this block to <code class="language-plaintext highlighter-rouge">aws_dynamodb_table</code> resource</p>
<pre><code class="language-hcl-terraform">  point_in_time_recovery {
    enabled = true
  }
</code></pre>

<h3 id="export-to-s3">Export to S3</h3>

<ul>
  <li>Go to “Exports and streams” tab in the Dynamo table page</li>
  <li>Click on “Export to S3” button</li>
  <li>Select the S3 bucket where you want to export</li>
  <li>Click on Export button</li>
  <li>You can see the status of the export</li>
</ul>

<h4 id="cross-account-backup">Cross account backup</h4>

<p>There are 2 ways to do the cross account backup</p>
<ul>
  <li>You can choose the different AWS account while selecting the S3 bucket and give permissions according to that</li>
  <li>You can export to an S3 bucket present in the current account and enable CRR (Cross Region Replication) to replicate the objects to another account</li>
</ul>

<p><img src="/assets/tech/dynamo-backup/export.png" /></p>

<p><img src="/assets/tech/dynamo-backup/export-page.png" /></p>

<h4 id="automating-the-backups-on-specific-intervals">Automating the backups on specific intervals</h4>
<ul>
  <li>Create a lambda</li>
  <li>
    <p>Write code to “Export to S3” using aws-sdk
Example code in JS (using aws-sdk version 3).
 <code class="language-plaintext highlighter-rouge">ecmascript 6
    const result = await dynamoDB.exportTableToPointInTime({ 
        TableArn: "&lt;&gt;", 
        S3Bucket: "&lt;&gt;" 
    });
</code></p>
  </li>
  <li>Schedule the lambda run using CloudWatch event rules (using schedule cron or rate expressions)</li>
</ul>

<h1 id="how-to-restore-the-backup">How to restore the backup?</h1>

<p>There is no direct import option similar to export option as above. 
Hopefully AWS will come up with straight forward import to DynamoDB. 
But for now, we have to manually read the data from S3 objects and insert into the DynamoDB table as part of restore process.</p>

<p>We can use traditional Data Pipelines to restore or Create a script</p>

<ul>
  <li>Stream backup files from S3</li>
  <li>Each Dynamo item stores as a single line in the backed up file</li>
  <li>Insert these objects into the table using sdk.</li>
</ul>

<h1 id="what-is-the-cost-of-backup">What is the Cost of backup?</h1>

<p>This is not a table scan solution, no extra infra/server. 
So, the cost of this solution is less comparing with Data Pipelines solution.</p>

<p>Taking the example of US east          <br />
For PITR    - $0.20 per GB-month        <br />
For export  - $0.10 per GB per export           <br />
and additional S3 cost.</p>


</article>



<section class="tags">
  <strong>Tags:</strong> <a href="/tag/aws">aws</a>,&nbsp;<a href="/tag/dynamoDB">dynamoDB</a>,&nbsp;<a href="/tag/backup">backup</a>
</section>



<section class="rss">
  <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
</section>

<section class="share">
  <span>Share: </span>
  
    
    
      <a href="//twitter.com/share?text=DynamoDB+backup+to+a+different+AWS+account&url=http%3A%2F%2Fmaheshkkolla.github.io%2Ftech%2F2021%2F05%2F07%2Fdynamodb-backup.html&via=Mahesh Kumar Kolla"
        onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
        <i class="fa fa-twitter-square fa-lg"></i>
      </a>
    
    
    
    
    
    
    
  
    
    
    
      <a href="//www.facebook.com/sharer.php?t=DynamoDB+backup+to+a+different+AWS+account&u=http%3A%2F%2Fmaheshkkolla.github.io%2Ftech%2F2021%2F05%2F07%2Fdynamodb-backup.html"
        onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
        <i class="fa fa-facebook-square fa-lg"></i>
      </a>
    
    
    
    
    
    
  
    
    
    
    
    
      <a href="//www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Fmaheshkkolla.github.io%2Ftech%2F2021%2F05%2F07%2Fdynamodb-backup.html"
        onclick="window.open(this.href, 'linkedin-share', 'width=550,height=255');return false;">
        <i class="fa fa-linkedin-square fa-lg"></i>
      </a>
    
    
    
    
  
</section>




<section class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'maheshkkolla';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



</div>
</div>

    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">Mahesh Kumar Kolla</h3>

		<div>
		<p><strong>Site Map</strong></p>
    <div class="site-navigation">
			<p><h5>Pages</h5></p>
      <ul class="pages">
        
        
					<li class="nav-link tag-link"><a href="/about/">About</a> | </li>
        
        
        
        
        
        
        
        
        
					<li class="nav-link tag-link"><a href="/posts/">Posts</a> | </li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </ul>
    </div>
		
		<div class="site-navigation">
			<p><h5>Categories</h5></p>
			<ul class="pages">
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
				<li class="nav-link tag-link"><a href="/category/non-tech/">non-tech</a> | </li>
				
        
        
				<li class="nav-link tag-link"><a href="/category/deploy-nodejs-application-on-a-raspberrypi/">deploy-nodejs-application-on-a-raspberrypi</a> | </li>
				
        
        
				<li class="nav-link tag-link"><a href="/category/tech/">tech</a> | </li>
				
        
        
        
        
        
        
        
      </ul>
    </div>

		<div class="site-navigation">
			<p><h5>Tags</h5></p>
			<ul class="pages">
        
        
        
        
        
        
        
        
        
        
        
        
					<li class="nav-link tag-link"><a href="/tag/thoughtworks/">thoughtworks</a> | </li>
        
        
        
					<li class="nav-link tag-link"><a href="/tag/step/">step</a> | </li>
        
        
        
					<li class="nav-link tag-link"><a href="/tag/school/">school</a> | </li>
        
        
        
					<li class="nav-link tag-link"><a href="/tag/childhood/">childhood</a> | </li>
        
        
        
					<li class="nav-link tag-link"><a href="/tag/mythoughts/">mythoughts</a> | </li>
        
        
        
					<li class="nav-link tag-link"><a href="/tag/tech/">tech</a> | </li>
        
        
        
					<li class="nav-link tag-link"><a href="/tag/nodejs/">nodejs</a> | </li>
        
        
        
					<li class="nav-link tag-link"><a href="/tag/raspberrypi/">raspberrypi</a> | </li>
        
        
        
					<li class="nav-link tag-link"><a href="/tag/mongodb/">mongodb</a> | </li>
        
        
        
					<li class="nav-link tag-link"><a href="/tag/ubuntu/">ubuntu</a> | </li>
        
        
        
					<li class="nav-link tag-link"><a href="/tag/docker/">docker</a> | </li>
        
        
        
					<li class="nav-link tag-link"><a href="/tag/aws/">aws</a> | </li>
        
        
        
					<li class="nav-link tag-link"><a href="/tag/s3/">s3</a> | </li>
        
        
        
					<li class="nav-link tag-link"><a href="/tag/terraform/">terraform</a> | </li>
        
        
        
					<li class="nav-link tag-link"><a href="/tag/life/">life</a> | </li>
        
        
        
					<li class="nav-link tag-link"><a href="/tag/corona/">corona</a> | </li>
        
        
        
					<li class="nav-link tag-link"><a href="/tag/dynamodb/">dynamoDB</a> | </li>
        
        
        
					<li class="nav-link tag-link"><a href="/tag/backup/">backup</a> | </li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </ul>
    </div>
		</div>

    <div class="site-contact">

      <p><strong>Contact</strong></p>
      <ul class="social-media-list">
        <li>
          <a href="mailto:mahesh.mk.245@gmail.com">
            <i class="fa fa-envelope-o"></i>
            <span class="username">mahesh.mk.245@gmail.com</span>
          </a>
        </li>

        
          
          <li>
            <a href="https://twitter.com/maheshkkolla" title="Follow me on Twitter">
              <i class="fa fa-twitter"></i>
              <span class="username">Mahesh Kumar Kolla</span>
            </a>
          </li>
          
        
          
          <li>
            <a href="https://www.facebook.com/maheshkkolla" title="Facebook">
              <i class="fa fa-facebook"></i>
              <span class="username">Mahesh Kumar Kolla</span>
            </a>
          </li>
          
        
          
          <li>
            <a href="https://www.linkedin.com/in/mahesh-kumar-kolla-75501113b/" title="Connect with me on LinkedIn">
              <i class="fa fa-linkedin"></i>
              <span class="username">Mahesh Kumar Kolla</span>
            </a>
          </li>
          
        

      </ul>
    </div>

    <div class="site-signature">
      <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
      <p class="text"></p>
    </div>

  </div>

</footer>

<!-- Scripts -->
<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/js/lightbox.min.js"></script>

<script type="text/javascript">
$(document).ready(function() {
  // Default syntax highlighting
  hljs.initHighlightingOnLoad();

  // Header
  var menuToggle = $('#js-mobile-menu').unbind();
  $('#js-navigation-menu').removeClass("show");
  menuToggle.on('click', function(e) {
    e.preventDefault();
    $('#js-navigation-menu').slideToggle(function(){
      if($('#js-navigation-menu').is(':hidden')) {
        $('#js-navigation-menu').removeAttr('style');
      }
    });
  });
});

</script>




<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-134133627-1', 'auto');
  ga('send', 'pageview', {
    'page': '/tech/2021/05/07/dynamodb-backup.html',
    'title': 'DynamoDB backup to a different AWS account'
  });
</script>



  </body>

</html>
